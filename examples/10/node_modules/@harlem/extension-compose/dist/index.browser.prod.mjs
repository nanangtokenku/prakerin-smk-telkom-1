var l="extension:compose";import{computed as y,onUnmounted as x}from"vue";import{objectFromPath as V,objectToPath as b,objectTrace as g,typeIsFunction as S,typeIsNil as E}from"@harlem/utilities";function A(e){let r=[].concat(S(e)?e():e);x(()=>r.forEach(({dispose:n})=>n()))}function D(){return e=>{e.register("extensions","compose",()=>"No options specified");let{value:r,getNodes:n,resetNodes:T}=g();function i(c,a){c(r);let t=n(),p=a||`extension:compose:${b(["root",...t])}`,o=t.pop(),u=s=>V(s,t);if(T(),E(o))throw new Error("A valid property must be used");let m=()=>u(e.state)[o];return[m,s=>e.write(p,l,d=>{u(d)[o]=S(s)?s(m()):s})]}function f(c,a){let[t,p]=i(c,a);return y({get:()=>t(),set:o=>p(o)})}return{useState:i,computeState:f,useListeners:A}}}export{D as default,A as useListeners};
