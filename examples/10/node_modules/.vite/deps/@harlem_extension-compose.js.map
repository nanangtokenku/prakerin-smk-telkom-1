{
  "version": 3,
  "sources": ["../../@harlem/extension-compose/dist/index.bundler.mjs"],
  "sourcesContent": ["// src/constants.ts\nvar SENDER = \"extension:compose\";\n\n// src/index.ts\nimport {\n  computed,\n  onUnmounted\n} from \"vue\";\nimport {\n  objectFromPath,\n  objectToPath,\n  objectTrace,\n  typeIsFunction,\n  typeIsNil\n} from \"@harlem/utilities\";\nfunction useListeners(listeners) {\n  const _listeners = [].concat(\n    typeIsFunction(listeners) ? listeners() : listeners\n  );\n  onUnmounted(() => _listeners.forEach(({ dispose }) => dispose()));\n}\nfunction composeExtension() {\n  return (store) => {\n    store.register(\"extensions\", \"compose\", () => \"No options specified\");\n    const {\n      value,\n      getNodes,\n      resetNodes\n    } = objectTrace();\n    function useState(accessor, mutationName) {\n      accessor(value);\n      const nodes = getNodes();\n      const name = mutationName || `extension:compose:${objectToPath([\"root\", ...nodes])}`;\n      const key = nodes.pop();\n      const parent = (state) => objectFromPath(state, nodes);\n      resetNodes();\n      if (typeIsNil(key)) {\n        throw new Error(\"A valid property must be used\");\n      }\n      const getter = () => parent(store.state)[key];\n      const setter = (value2) => store.write(name, SENDER, (state) => {\n        parent(state)[key] = typeIsFunction(value2) ? value2(getter()) : value2;\n      });\n      return [\n        getter,\n        setter\n      ];\n    }\n    function computeState(accessor, mutationName) {\n      const [\n        getter,\n        setter\n      ] = useState(accessor, mutationName);\n      return computed({\n        get: () => getter(),\n        set: (value2) => setter(value2)\n      });\n    }\n    return {\n      useState,\n      computeState,\n      useListeners\n    };\n  };\n}\nexport {\n  composeExtension as default,\n  useListeners\n};\n"],
  "mappings": ";;;;;;;;;;;;;AACA,IAAI,SAAS;AAcb,SAAS,aAAa,WAAW;AAC/B,QAAM,aAAa,CAAC,EAAE;AAAA,IACpB,WAAe,SAAS,IAAI,UAAU,IAAI;AAAA,EAC5C;AACA,cAAY,MAAM,WAAW,QAAQ,CAAC,EAAE,QAAQ,MAAM,QAAQ,CAAC,CAAC;AAClE;AACA,SAAS,mBAAmB;AAC1B,SAAO,CAAC,UAAU;AAChB,UAAM,SAAS,cAAc,WAAW,MAAM,sBAAsB;AACpE,UAAM;AAAA,MACJ;AAAA,MACA;AAAA,MACA;AAAA,IACF,IAAI,YAAY;AAChB,aAAS,SAAS,UAAU,cAAc;AACxC,eAAS,KAAK;AACd,YAAM,QAAQ,SAAS;AACvB,YAAM,OAAO,gBAAgB,qBAAqB,OAAa,CAAC,QAAQ,GAAG,KAAK,CAAC;AACjF,YAAM,MAAM,MAAM,IAAI;AACtB,YAAM,SAAS,CAAC,UAAU,SAAe,OAAO,KAAK;AACrD,iBAAW;AACX,UAAI,MAAU,GAAG,GAAG;AAClB,cAAM,IAAI,MAAM,+BAA+B;AAAA,MACjD;AACA,YAAM,SAAS,MAAM,OAAO,MAAM,KAAK,EAAE;AACzC,YAAM,SAAS,CAAC,WAAW,MAAM,MAAM,MAAM,QAAQ,CAAC,UAAU;AAC9D,eAAO,KAAK,EAAE,OAAO,WAAe,MAAM,IAAI,OAAO,OAAO,CAAC,IAAI;AAAA,MACnE,CAAC;AACD,aAAO;AAAA,QACL;AAAA,QACA;AAAA,MACF;AAAA,IACF;AACA,aAAS,aAAa,UAAU,cAAc;AAC5C,YAAM;AAAA,QACJ;AAAA,QACA;AAAA,MACF,IAAI,SAAS,UAAU,YAAY;AACnC,aAAO,SAAS;AAAA,QACd,KAAK,MAAM,OAAO;AAAA,QAClB,KAAK,CAAC,WAAW,OAAO,MAAM;AAAA,MAChC,CAAC;AAAA,IACH;AACA,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AACF;",
  "names": []
}
